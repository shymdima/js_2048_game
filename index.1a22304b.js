const e=new class{areArraysEqual(e,t){return e.length===t.length&&e.every((e,n)=>e===t[n])}createRandomNumbers(e){1>=Math.floor(11*Math.random())?e.textContent="4":e.textContent="2",e.className=`field-cell cell-${e.textContent}`}initiateGame(){let e;let t=document.querySelectorAll(".field-cell"),n=Math.floor(16*Math.random());do e=Math.floor(16*Math.random());while(e===n)this.createRandomNumbers(t[n]),this.createRandomNumbers(t[e])}moveZerosToEnd(e){let t=e.filter(e=>0!==e);for(let e=1;e<t.length;e++)t[e]===t[e-1]&&(t[e-1]*=2,2048===t[e-1]&&this.gameWin(),t[e]=0,this.getScore(t[e-1]),e--);t=t.filter(e=>0!==e);let n=e.length-t.length;return[...t,...Array(n).fill(0)]}moveZerosToStart(e){let t=e.filter(e=>0!==e);for(let e=1;e<t.length;e++)t[e]===t[e-1]&&(t[e-1]*=2,2048===t[e-1]&&this.gameWin(),t[e]=0,this.getScore(t[e-1]),e--);return t=t.filter(e=>0!==e),[...Array(e.length-t.length).fill(0),...t]}getScore(e){let t=document.querySelector(".game-score"),n=+t.textContent;n+=e,t.textContent=n}moveLeftEventListener(e){if("ArrowLeft"===e.key){let e=document.querySelectorAll(".field-row"),t=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);e.forEach(e=>{let t=[...e.querySelectorAll("td")],n=t.map(e=>parseInt(e.textContent)||0),l=this.moveZerosToEnd(n);e.innerHTML="",l.forEach((n,l)=>{let o=t[l];0===n?(o.textContent="",o.className="field-cell"):(o.textContent=n,o.className=`field-cell cell-${n}`),e.appendChild(o)})});let n=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);this.areArraysEqual(t,n)?this.gameOver():this.addCell()}}moveLeft(){window.addEventListener("keydown",this.boundMoveLeftListener)}moveRightEventListener(e){if("ArrowRight"===e.key){let e=document.querySelectorAll(".field-row"),t=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);e.forEach(e=>{let t=[...e.querySelectorAll("td")],n=t.map(e=>parseInt(e.textContent)||0),l=this.moveZerosToStart(n);e.innerHTML="",l.forEach((n,l)=>{let o=t[l];0===n?(o.textContent="",o.className="field-cell"):(o.textContent=n,o.className=`field-cell cell-${n}`),e.appendChild(o)})});let n=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);this.areArraysEqual(t,n)?this.gameOver():this.addCell()}}moveRight(){window.addEventListener("keydown",this.boundMoveRightListener)}moveUpEventListener(e){if("ArrowUp"===e.key){let e=document.querySelectorAll(".field-row"),t=[[],[],[],[]],n=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);e.forEach(e=>{for(let n=0;n<4;n++){let l=e.querySelector(`td:nth-child(${n+1})`);l&&t[n].push(l)}}),t.forEach(e=>{let t=e.map(e=>parseInt(e.textContent)||0);this.moveZerosToEnd(t).forEach((t,n)=>{0===t?(e[n].textContent="",e[n].className="field-cell"):(e[n].textContent=t,e[n].className=`field-cell cell-${t}`)})});let l=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);this.areArraysEqual(n,l)?this.gameOver():this.addCell()}}moveUp(){window.addEventListener("keydown",this.boundMoveUpListener)}moveDownEventListener(e){if("ArrowDown"===e.key){let e=document.querySelectorAll(".field-row"),t=[[],[],[],[]],n=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);e.forEach(e=>{for(let n=0;n<4;n++){let l=e.querySelector(`td:nth-child(${n+1})`);l&&t[n].push(l)}}),t.forEach(e=>{let t=e.map(e=>parseInt(e.textContent)||0);this.moveZerosToStart(t).forEach((t,n)=>{0===t?(e[n].textContent="",e[n].className="field-cell"):(e[n].textContent=t,e[n].className=`field-cell cell-${t}`)})});let l=[...document.querySelectorAll(".field-cell")].map(e=>parseInt(e.textContent)||0);this.areArraysEqual(n,l)?this.gameOver():this.addCell()}}moveDown(){window.addEventListener("keydown",this.boundMoveDownListener)}getStatus(){}startFunction(){let e=document.querySelector(".start"),t=document.querySelector(".message-start");e&&(e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"),t&&(t.classList.add("hidden"),this.boundMoveLeftListener=this.moveLeftEventListener.bind(this),this.boundMoveRightListener=this.moveRightEventListener.bind(this),this.boundMoveUpListener=this.moveUpEventListener.bind(this),this.boundMoveDownListener=this.moveDownEventListener.bind(this),this.moveLeft(),this.moveRight(),this.moveUp(),this.moveDown(),this.restart(),this.initiateGame()))}start(){let e=document.querySelector(".start");e?e.addEventListener("click",this.startFunction.bind(this)):e.removeEventListener("click",this.startFunction.bind(this))}restart(){let e=document.querySelector(".restart");e&&e.addEventListener("click",()=>{let e=document.querySelector(".game-score"),t=document.querySelectorAll(".field-cell");if(2===[...t].map(e=>parseInt(e.textContent)||0).filter(e=>0!==e).length&&"0"===e.textContent);else{t.forEach(e=>{e.textContent="",e.className="field-cell"}),this.addCell(),this.addCell(),e.textContent=0;let n=document.querySelector(".message-lose"),l=document.querySelector(".message-win");n.classList.add("hidden"),l.classList.add("hidden")}})}checkBeforeGameOver(){let e=document.querySelectorAll(".field-row"),t=[[],[],[],[]];for(let n of(e.forEach(e=>{for(let n=0;n<4;n++){let l=e.querySelector(`td:nth-child(${n+1})`);l&&t[n].push(l)}}),e)){let e=[...n.querySelectorAll("td")].map(e=>parseInt(e.textContent)||0);for(let t=0;t<e.length-1;t++)if(0===e[t]||e[t]===e[t+1])return!1}for(let e of t){let t=e.map(e=>parseInt(e.textContent)||0);for(let e=0;e<t.length-1;e++)if(0===t[e]||t[e]===t[e+1])return!1}return!0}gameWin(){document.querySelector(".message-win").classList.remove("hidden"),window.removeEventListener("keydown",this.boundMoveUpListener),window.removeEventListener("keydown",this.boundMoveDownListener),window.removeEventListener("keydown",this.boundMoveLeftListener),window.removeEventListener("keydown",this.boundMoveRightListener)}gameOver(){this.checkBeforeGameOver()&&(document.querySelector(".message-lose").classList.remove("hidden"),window.removeEventListener("keydown",this.boundMoveUpListener),window.removeEventListener("keydown",this.boundMoveDownListener),window.removeEventListener("keydown",this.boundMoveLeftListener),window.removeEventListener("keydown",this.boundMoveRightListener))}addCell(){let e=[...document.querySelectorAll(".field-cell")].filter(e=>0===e.textContent.length),t=Math.floor(Math.random()*e.length);this.createRandomNumbers(e[t])}};e.start(),e.restart();
//# sourceMappingURL=index.1a22304b.js.map
